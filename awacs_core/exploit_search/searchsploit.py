import json
import subprocess

def jsonify(object, attribute):
    return json.loads(object)[attribute]

def search(name,version):
  exploits = []
  template = f"{name} {version}"
  output = subprocess.check_output(f"searchsploit --json \"{template}\"", shell=True).decode('latin-1').strip()
  searchsploit_exploits = jsonify(output, 'RESULTS_EXPLOIT')
  if len(searchsploit_exploits) > 0:
      exploit = searchsploit_exploits[0]['Path']
      exploits.append({"name":template, "exploit":exploit})
  return exploits